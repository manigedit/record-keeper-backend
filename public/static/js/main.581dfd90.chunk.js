(this["webpackJsonprecord-keeper-frontend"]=this["webpackJsonprecord-keeper-frontend"]||[]).push([[0],{102:function(e,t,r){},103:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(25),i=r.n(s),c=(r(36),r(37),r(26)),l=r(27),o=r(4),u=r(30),d=r(29),h=r(28),m=r.n(h),f="http://localhost:3000/api/v1/",E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=m.a.create({baseURL:e,timeout:1e4}),r=function(e){return t.post("/users",e)},a=function(){return t.get("/entries")},n=function(e){return t.get("/entries/".concat(e))},s=function(e){return t.post("/entries",e)};return{createUser:r,getEntries:a,getOldEntriesByUser:n,createNewEntry:s}}(),g=(r(102),function(e){Object(u.a)(r,e);var t=Object(d.a)(r);function r(e){var a;Object(c.a)(this,r),a=t.call(this,e);var s=localStorage.getItem("samajhUser");if(s){console.log("Found saved user",s);var i=JSON.parse(s)._id;a.state={fetchOldEntriesRequest:!0,fetchOldEntriesSucess:!1,fetchOldEntriesFailure:!1,submitNewEntryRequest:!1,submitNewEntrySuccess:!1,submitNewEntryFailure:!1,submittedImages:[],totalImages:[],isOldUser:!0,userId:i,oldEntries:[],folderPicked:!1}}else console.log("No saved user found",s),a.state={createNewUserRequest:!1,createNewUserSucess:!1,createNewUserFailure:!1,submitNewEntryRequest:!1,submitNewEntrySuccess:!1,submitNewEntryFailure:!1,submittedImages:[],totalImages:[],isOldUser:!1,userId:"".concat(+new Date),oldEntries:[],folderPicked:!1};return a.directoryRef=n.a.createRef(),a.getEntriesByUser=a.getEntriesByUser.bind(Object(o.a)(a)),a.createNewEntry=a.createNewEntry.bind(Object(o.a)(a)),a.handleSubmitButton=a.handleSubmitButton.bind(Object(o.a)(a)),a.handleSkipButton=a.handleSkipButton.bind(Object(o.a)(a)),a.handleDirectoryChange=a.handleDirectoryChange.bind(Object(o.a)(a)),a}return Object(l.a)(r,[{key:"getEntriesByUser",value:function(e){var t=this;this.setState({fetchOldEntriesRequest:!0}),E.getOldEntriesByUser(e).then((function(e){e.ok?t.setState({fetchOldEntriesRequest:!1,fetchOldEntriesSucess:!0,fetchOldEntriesFailure:!1,oldEntries:e.data}):t.setState({fetchOldEntriesRequest:!1,fetchOldEntriesFailure:!0,fetchOldEntriesSucess:!1,oldEntries:[]})}),(function(e){console.log("Error while fetching old entries",e),t.setState({fetchOldEntriesRequest:!1,fetchOldEntriesFailure:!0})}))}},{key:"createNewUser",value:function(e){var t=this;this.setState({createNewUserRequest:!0}),E.createUser({_id:e,createdOn:new Date}).then((function(e){e.ok?(t.setState({createNewUserRequest:!1,createNewEntrySuccess:!0,createNewUserFailure:!1,userId:e.data._id}),t.generateNewPrompt(),localStorage.setItem("samajhUser",JSON.stringify(e.data))):t.setState({createNewUserRequest:!1,createNewEntrySuccess:!1,createNewUserFailure:!0})}),(function(e){console.log("Error occurred while creating user",e),t.setState({createNewUserFailure:!0,createNewEntrySuccess:!1})}))}},{key:"generateNewPrompt",value:function(){var e=this.state,t=e.imageIndex;t>=e.totalImages.length-1?alert("all the images were already processed"):this.setState({currentImage:"something_".concat(+new Date),value:"",imageIndex:t+1})}},{key:"createNewEntry",value:function(e){var t=this;this.setState({createNewEntryRequest:!0}),E.createNewEntry(e).then((function(e){e.ok?(t.setState({createNewEntryRequest:!1,createNewEntrySuccess:!0,createNewEntryFailure:!1}),t.generateNewPrompt()):t.setState({createNewEntryRequest:!1,createNewEntryFailure:!0,createNewEntrySuccess:!1})}),(function(e){console.log("Error in creating new entry",e),t.setState({createNewEntryRequest:!1,createNewEntryFailure:!0})}))}},{key:"handleSubmitButton",value:function(){var e=this.state,t=e.userId,r=e.value,a=e.imageIndex,n=e.totalImages;r?(console.log("here from handle submit ",n[a]),this.createNewEntry({userId:t,path:n[a].webkitRelativePath,value:r,timestamp:new Date})):alert("Please provide a valid value")}},{key:"handleSkipButton",value:function(){this.generateNewPrompt()}},{key:"handleDirectoryChange",value:function(){console.log("From handle directory change",this.directoryRef.current.files[4]),console.log("Here is one of the file url",URL.createObjectURL(this.directoryRef.current.files[4]));var e,t=this.state,r=t.isOldUser,a=t.oldEntries;r?this.setState({folderPicked:!0,imageIndex:0,totalImages:Array.from(this.directoryRef.current.files).filter((e=a,function(t){return 0==e.filter((function(e){return e.path==t.webkitRelativePath})).length}))}):this.setState({folderPicked:!0,imageIndex:0,totalImages:this.directoryRef.current.files})}},{key:"componentDidMount",value:function(){var e=this.state,t=e.isOldUser,r=e.userId;t?this.getEntriesByUser(r):this.createNewUser(r)}},{key:"render",value:function(){var e=this,t=this.state,r=t.fetchOldEntriesRequest,a=(t.fetchOldEntriesSucess,t.fetchOldEntriesFailure,t.createNewEntryRequest),s=(t.submitNewEntrySuccess,t.submitNewEntryFailure,t.submittedImages,t.isOldUser,t.oldEntries,t.currentImage,t.folderPicked),i=t.imageIndex,c=t.totalImages,l=t.userId;t.value;return r?n.a.createElement("div",null,"Please wait while we analyze your previous submittions"):a?n.a.createElement("div",null,"Please wait while we submit your current entry"):l?n.a.createElement("div",null,"Welcome userID ",l,", Please select a local folder with images then provide the values or skip the image.",n.a.createElement("p",null,n.a.createElement("input",{ref:this.directoryRef,onChange:this.handleDirectoryChange,directory:"",webkitdirectory:"",type:"file"})),s?n.a.createElement("div",null," ",n.a.createElement("img",{className:"image-box",src:URL.createObjectURL(c[i])}),n.a.createElement("div",{className:"TxtInputFrame"},"Image Details"),n.a.createElement("input",{type:"text",className:"InputFrame",placeholder:"Image Data",value:this.state.value,required:!0,onChange:function(t){e.setState({value:t.target.value.trim()})}}),n.a.createElement("button",{type:"button",onClick:this.handleSubmitButton},"Submit Button"),n.a.createElement("p",null,n.a.createElement("button",{onClick:this.handleSkipButton},"Skip"))):n.a.createElement("div",null,"Thanks")," "):n.a.createElement("div",null,"Failed to handle the cases")}}]),r}(a.Component));var w=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(g,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},31:function(e,t,r){e.exports=r(103)},36:function(e,t,r){},37:function(e,t,r){}},[[31,1,2]]]);
//# sourceMappingURL=main.581dfd90.chunk.js.map